---
layout: post
title: "kNN (k-Nearest Neighbor) 구현하기"
description: kNN (k-Nearest Neighbor) 구현하기
#tags: Algorithm
date: 2020-05-27 10:38:08
comments: true
---

<!-- knn k means 구분해서 설명 -->

## kNN (k-Nearest Neighbor)

kNN은 k개의 최근접 이웃을 이용해 분류, 회귀를 하는 방식입니다.

## K-means clustering

```py
from math import sqrt,sin,cos,pi
import matplotlib.pyplot as plt
import numpy as np

N = 100
k = 5
GROUD_TRUTH = None

def getRandomDataSet(pointsNum,sigma = 1.0,centroids=4,center_range=(0,10)):
    global GROUD_TRUTH
    GROUD_TRUTH = np.random.randint(center_range[0],center_range[1],size=(centroids,2))
    result = np.zeros((pointsNum*centroids,2))
    for i in range(centroids):
        x = np.random.normal(loc=GROUD_TRUTH[i][0],scale=sigma,size=pointsNum)
        y = np.random.normal(loc=GROUD_TRUTH[i][1],scale=sigma,size=pointsNum)
        for j in range(pointsNum):
            result[i*pointsNum + j][0] = x[j]
            result[i*pointsNum + j][1] = y[j]
    return result

def plot(data):
    plt.scatter([p[0] for p in data],[p[1] for p in data])
    plt.scatter([p[0] for p in GROUD_TRUTH],[p[1] for p in GROUD_TRUTH],c='r',marker='x')
    plt.grid(); plt.show()

def getEuclideanDistance(p1,p2):
    return sqrt((p1[0]-p2[0])**2 + (p1[1]-p2[1])**2)

def getTransform(theta,transX,transY):
    return np.array([[cos(theta),-sin(theta),transX],
                    [sin(theta),cos(theta),transY],
                    [0,0,1]])

def getNearestNeighbor(points,p):
    minIndex = 0
    minValue = 9999
    for i in range(len(points)):
        tmpValue = getEuclideanDistance(points[i],p)
        if minValue > tmpValue:
            minValue = tmpValue
            minIndex = i
    return minIndex, points[minIndex]

def main():
    dataset = getRandomDataSet(N)
    plot(dataset)

if __name__ == "__main__":
    main()
    
```

### Algorithm

<!-- psuedocode 설명? -->

---

<details>
<summary>참고문서</summary>
<div markdown="1">

- [k-nearest neighbors algorithm - Wikipedia](https://en.wikipedia.org/w/index.php?title=K-nearest_neighbors_algorithm&oldid=965347982)
- [implement-k-nearest-neighbors-in-python-from-scratch](https://machinelearningmastery.com/tutorial-to-implement-k-nearest-neighbors-in-python-from-scratch/)
- [k-means clustering - Wikipedia](https://en.wikipedia.org/wiki/K-means_clustering)
- <a href="https://medium.com/@rishit.dagli/build-k-means-from-scratch-in-python-e46bf68aa875#:~:text=K%2Dmeans%20clustering%20is%20a,without%20defined%20categories%20or%20groups).&text=The%20centroids%20of%20the%20K,assigned%20to%20a%20single%20cluster)">build-k-means-from-scratch-in-python</a>


</div>
</details>
<script id="dsq-count-scr" src="//msc9533.disqus.com/count.js" async></script>

